<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; img-src 'self' data:; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; font-src 'self' https://cdn.jsdelivr.net; connect-src https://api.siliconflow.com;">
  <title>简易图片编辑器</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <script src="public/libs/fabric.min.js"></script>
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <h1>简易图片编辑器</h1>
      <div class="tool-buttons">
        <button id="open-image" class="btn btn-primary"><i class="bi bi-folder-fill me-1"></i>打开图片</button>
        <button id="save-image" class="btn btn-success"><i class="bi bi-save-fill me-1"></i>保存图片</button>
      </div>
    </header>
    
    <div class="main-content">
      <div class="sidebar left-sidebar">
        <h3 class="sidebar-title"><i class="bi bi-tools me-2"></i>编辑工具</h3>
        <div class="tools-section">
          <button id="filter-brightness" class="btn btn-outline-secondary w-100 mb-2"><i class="bi bi-brightness-high me-1"></i>亮度</button>
          <button id="filter-contrast" class="btn btn-outline-secondary w-100 mb-2"><i class="bi bi-circle-half me-1"></i>对比度</button>
          <button id="filter-saturation" class="btn btn-outline-secondary w-100 mb-2"><i class="bi bi-palette me-1"></i>饱和度</button>
          <button id="crop-image" class="btn btn-outline-secondary w-100 mb-2"><i class="bi bi-crop me-1"></i>裁剪</button>
          <button id="rotate-image" class="btn btn-outline-secondary w-100 mb-2"><i class="bi bi-arrow-clockwise me-1"></i>旋转</button>
          <button id="draw-tool" class="btn btn-outline-secondary w-100 mb-2"><i class="bi bi-pencil me-1"></i>绘画</button>
          <button id="add-text" class="btn btn-outline-secondary w-100 mb-2"><i class="bi bi-type me-1"></i>添加文字</button>
          <button id="add-sticker" class="btn btn-outline-secondary w-100 mb-2"><i class="bi bi-emoji-smile me-1"></i>添加贴纸</button>
        </div>
        
        <h3 class="sidebar-title mt-4"><i class="bi bi-robot me-2"></i>AI生成图像</h3>
        <div class="ai-section">
          <textarea id="ai-prompt" class="form-control mb-2" placeholder="输入描述，生成图像..."></textarea>
          <button id="generate-image" class="btn btn-primary w-100"><i class="bi bi-magic me-1"></i>生成图像</button>
          <div id="ai-status" class="mt-2 small text-center"></div>
        </div>
      </div>
      
      <div class="canvas-container">
        <canvas id="editor-canvas"></canvas>
        <div id="canvas-message" class="alert alert-info">打开图片或创建新画布开始编辑</div>
      </div>
      
      <div class="sidebar right-sidebar">
        <h3 class="sidebar-title"><i class="bi bi-layers-fill me-2"></i>图层</h3>
        <div class="layers-section">
          <div class="layers-header">
            <button id="add-layer" class="btn btn-sm btn-outline-primary"><i class="bi bi-plus"></i> 添加</button>
            <button id="delete-layer" class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i> 删除</button>
          </div>
          <div id="layers-list" class="layers-list list-group mt-2">
            <!-- 图层项将通过JavaScript动态添加 -->
          </div>
        </div>
        
        <h3 class="sidebar-title mt-4"><i class="bi bi-clock-history me-2"></i>历史记录</h3>
        <div class="history-section">
          <div class="history-header">
            <button id="undo-action" class="btn btn-sm btn-outline-secondary"><i class="bi bi-arrow-counterclockwise"></i> 撤销</button>
            <button id="redo-action" class="btn btn-sm btn-outline-secondary"><i class="bi bi-arrow-clockwise"></i> 重做</button>
          </div>
          <div id="history-list" class="history-list list-group mt-2">
            <!-- 历史记录项将通过JavaScript动态添加 -->
          </div>
        </div>
      </div>
    </div>
    
    <div id="debug-panel" class="debug-panel collapsed">
      <div class="debug-header">
        <h3><i class="bi bi-bug-fill me-2"></i>调试信息</h3>
        <button id="toggle-debug" class="toggle-debug btn btn-sm btn-secondary">展开</button>
      </div>
      <div id="debug-content" class="debug-content"></div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="renderer.js"></script>
</body>
</html> 